### **Урок 5: Реализация CRUD-операций** 💾

Наши админ-панель и магазин выглядят отлично, но пока что наша админка не умеет ничего, кроме просмотра товаров. На этом занятии мы добавим полную **CRUD (Create, Read, Update, Delete)**-функциональность, реализовав методы в нашем `dataProvider`.

Мы будем изменять наш массив `productsData` напрямую, имитируя работу с базой данных.

-----

### **1. Обновление файла данных (`products.js`)**

Чтобы иметь возможность изменять массив `products`, мы должны экспортировать его не как `const`, а как `let`. Это позволит нам добавлять, удалять и редактировать элементы. Мы также добавим простую переменную для генерации уникальных ID для новых товаров.

**Файл: `src/data/products.js`**

```jsx
let products = [
  {
    id: 1,
    name: 'Смартфон Altel',
    price: 99990,
    image: 'https://via.placeholder.com/300x300.png?text=Smartphone',
    description: 'Мощный смартфон с отличной камерой и длительным временем автономной работы. Идеально подходит для работы и развлечений.'
  },
  {
    id: 2,
    name: 'Ноутбук Altel',
    price: 249990,
    image: 'https://via.placeholder.com/300x300.png?text=Laptop',
    description: 'Легкий и производительный ноутбук. Идеален для офисной работы, учебы и просмотра фильмов.'
  },
  {
    id: 3,
    name: 'Наушники Altel',
    price: 15990,
    image: 'https://via.placeholder.com/300x300.png?text=Headphones',
    description: 'Беспроводные наушники с чистым звуком и удобной посадкой. До 24 часов работы.'
  },
  {
    id: 4,
    name: 'Умные часы Altel',
    price: 35990,
    image: 'https://via.placeholder.com/300x300.png?text=Smartwatch',
    description: 'Отслеживание активности, уведомления со смартфона и стильный дизайн. Ваш личный помощник на запястье.'
  },
  {
    id: 5,
    name: 'Игровая мышь Altel',
    price: 8990,
    image: 'https://via.placeholder.com/300x300.png?text=Gaming+Mouse',
    description: 'Эргономичный дизайн и высокоточный сенсор для максимальной производительности в играх.'
  }
];

// Переменная для генерации ID
let nextId = products.length + 1;

export { products, nextId };
```

-----

### **2. Добавление CRUD-логики в `dataProvider.js`**

Теперь обновим наш `dataProvider` для реализации методов `create`, `update` и `delete`. Мы будем использовать стандартные методы массивов JavaScript, такие как `push`, `map` и `filter`.

**Файл: `src/admin/dataProvider.js`**

```jsx
import { products, nextId } from '../data/products'; // Импортируем измененные данные

const dataProvider = {
  // Read: Получение списка
  getList: (resource, params) => {
    if (resource === 'products') {
      return Promise.resolve({
        data: products,
        total: products.length,
      });
    }
    return Promise.resolve({ data: [], total: 0 });
  },
  
  // Read: Получение одного элемента
  getOne: (resource, params) => {
    if (resource === 'products') {
      const product = products.find(p => p.id === parseInt(params.id));
      return Promise.resolve({ data: product });
    }
    return Promise.resolve({ data: null });
  },
  
  // Create: Создание нового элемента
  create: (resource, params) => {
    if (resource === 'products') {
      const newProduct = { ...params.data, id: nextId++ };
      products.push(newProduct);
      return Promise.resolve({ data: newProduct });
    }
    return Promise.resolve({ data: {} });
  },
  
  // Update: Обновление существующего элемента
  update: (resource, params) => {
    if (resource === 'products') {
      products = products.map(p =>
        p.id === parseInt(params.id) ? { ...p, ...params.data } : p
      );
      return Promise.resolve({ data: { ...params.data, id: parseInt(params.id) } });
    }
    return Promise.resolve({ data: {} });
  },
  
  // Delete: Удаление элемента
  delete: (resource, params) => {
    if (resource === 'products') {
      products = products.filter(p => p.id !== parseInt(params.id));
      return Promise.resolve({ data: {} });
    }
    return Promise.resolve({ data: {} });
  },

  // Эти методы пока не нужны, но их лучше оставить
  updateMany: () => Promise.resolve({ data: [] }),
  deleteMany: () => Promise.resolve({ data: [] }),
  getMany: () => Promise.resolve({ data: [] }),
  getManyReference: () => Promise.resolve({ data: [] }),
};

export default dataProvider;
```

-----

