## –£—Ä–æ–∫ 11: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø–æ–∏—Å–∫ —Å Debounce –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π üîç

-----

–ù–∞ —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç –≤ –º–∞–≥–∞–∑–∏–Ω–µ, –¥–æ–±–∞–≤–∏–≤ –º–æ—â–Ω—É—é –∏ –±—ã—Å—Ç—Ä—É—é —Å–∏—Å—Ç–µ–º—É –ø–æ–∏—Å–∫–∞. –ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Material-UI** –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, **JSON Server API** –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ —Ç–µ—Ö–Ω–∏–∫—É **Debounce** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

### **1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π)**

–î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–∏—Å–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –Ω–∞–º –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –Ω–∞—à –±—ç–∫–µ–Ω–¥. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `db.json` –∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–µ `category` –∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Ç–æ–≤–∞—Ä–∞–º.

**–§–∞–π–ª: `db.json` (—Ñ—Ä–∞–≥–º–µ–Ω—Ç)**

```json
{
  "products": [
    {
      "id": 1,
      "name": "–°–º–∞—Ä—Ç—Ñ–æ–Ω Altel",
      "price": 99990,
      "image": "...",
      "description": "...",
      "category": "–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã"
    }
  ]
}
```

-----

### **2. –•—É–∫ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: useDebounce** ‚è±Ô∏è

**Debounce** –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏ –∫–∞–∂–¥–æ–º –Ω–∞–∂–∞—Ç–∏–∏ –∫–ª–∞–≤–∏—à–∏, –æ–∂–∏–¥–∞—è –ø–∞—É–∑—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, 500 –º—Å).

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `src/hooks/useDebounce.js`.

**–§–∞–π–ª: `src/hooks/useDebounce.js`**

```jsx
import { useState, useEffect } from 'react';

/**
 * –•—É–∫ –¥–ª—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è.
 */
function useDebounce(value, delay) {
  const [debouncedValue, setDebouncedValue] = useState(value);

  useEffect(() => {
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è debouncedValue
    const handler = setTimeout(() => {
      setDebouncedValue(value);
    }, delay);

    // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ç–∞–π–º–µ—Ä–∞ (–æ—Ç–º–µ–Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –≤—ã–∑–æ–≤–∞)
    return () => {
      clearTimeout(handler);
    };
  }, [value, delay]);

  return debouncedValue;
}

export default useDebounce;
```

-----

### **3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤**

–û–±–Ω–æ–≤–∏–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–∞—Ç–∞–ª–æ–≥–∞, –¥–æ–±–∞–≤–∏–≤ –ø–æ–ª—è –ø–æ–∏—Å–∫–∞ –∏ –ª–æ–≥–∏–∫—É API-–∑–∞–ø—Ä–æ—Å–æ–≤.

**–§–∞–π–ª: `src/store/pages/ProductListPage.jsx`**

```jsx
import React, { useState, useEffect } from 'react';
import { Container, Typography, Grid, TextField, Select, MenuItem, InputLabel, FormControl, CircularProgress, Box } from '@mui/material';
import ProductCard from '../components/ProductCard';
import useDebounce from '../../hooks/useDebounce'; 

const categories = ['–í—Å–µ', '–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã', '–ù–æ—É—Ç–±—É–∫–∏', '–ù–∞—É—à–Ω–∏–∫–∏', '–£–º–Ω—ã–µ —á–∞—Å—ã', '–ò–≥—Ä–æ–≤—ã–µ –º—ã—à–∏'];

const ProductListPage = () => {
  const [products, setProducts] = useState([]);
  const [loading, setLoading] = useState(false);
  const [searchTerm, setSearchTerm] = useState('');
  const [categoryFilter, setCategoryFilter] = useState('–í—Å–µ');

  const debouncedSearchTerm = useDebounce(searchTerm, 500);
  const API_URL = 'http://localhost:3001/products'; 

  useEffect(() => {
    const fetchProducts = async () => {
      setLoading(true);
      
      // –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ JSON-Server
      let url = `${API_URL}?_limit=10`; 
      
      // –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é (q) –∏ —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
      if (debouncedSearchTerm) {
        url += `&q=${debouncedSearchTerm}`; 
      }
      if (categoryFilter !== '–í—Å–µ') {
        url += `&category=${categoryFilter}`;
      }
      
      // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
      try {
        const response = await fetch(url);
        if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏');
        const data = await response.json();
        setProducts(data);
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ:', error);
        setProducts([]);
      } finally {
        setLoading(false);
      }
    };

    fetchProducts();
  }, [debouncedSearchTerm, categoryFilter]); 

  return (
    <Container>
      <Typography variant="h3" gutterBottom sx={{ mt: 4 }}>
        –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤
      </Typography>

      {/* –ü–∞–Ω–µ–ª—å –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ MUI */}
      <Box display="flex" gap={2} mb={4}>
        <TextField
          label="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é"
          variant="outlined"
          value={searchTerm}
          onChange={(e) => setSearchTerm(e.target.value)}
          fullWidth
        />
        <FormControl variant="outlined" sx={{ minWidth: 200 }}>
          <InputLabel>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</InputLabel>
          <Select
            value={categoryFilter}
            onChange={(e) => setCategoryFilter(e.target.value)}
            label="–ö–∞—Ç–µ–≥–æ—Ä–∏—è"
          >
            {categories.map((cat) => (
              <MenuItem key={cat} value={cat}>
                {cat}
              </MenuItem>
            ))}
          </Select>
        </FormControl>
      </Box>

      {/* –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */}
      {loading ? (
        <Box display="flex" justifyContent="center" py={5}>
          <CircularProgress />
        </Box>
      ) : (
        <Grid container spacing={4}>
          {products.length > 0 ? (
            products.map((product) => (
              <Grid item key={product.id} xs={12} sm={6} md={4}>
                <ProductCard product={product} />
              </Grid>
            ))
          ) : (
            <Typography variant="h6" sx={{ p: 3 }}>
              –¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å.
            </Typography>
          )}
        </Grid>
      )}
    </Container>
  );
};

export default ProductListPage;

/*
 * =========================================================================================
 * –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è: –ë–∏–Ω–∞—Ä–Ω—ã–π –ø–æ–∏—Å–∫ (Binary Search)
 * =========================================================================================
 *
 * –ë–∏–Ω–∞—Ä–Ω—ã–π –ø–æ–∏—Å–∫ ‚Äî —ç—Ç–æ –æ—á–µ–Ω—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º (O(log n)), –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç
 * **—Ç–æ–ª—å–∫–æ —Å –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏** –∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –ª–∏–Ω–µ–π–Ω—ã–π –ø–æ–∏—Å–∫.
 *
 * –í–º–µ—Å—Ç–æ —á–µ–≥–æ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?
 * - –ï—Å–ª–∏ –±—ã –º—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏ **–≤–µ—Å—å** –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 100 000 –∑–∞–ø–∏—Å–µ–π)
 * –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (—á—Ç–æ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö!) –∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏ –µ–≥–æ
 * –ø–æ —Ü–µ–Ω–µ –∏–ª–∏ ID, —Ç–æ —ç—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –∑–∞–º–µ–Ω–∏–ª –±—ã —Å–æ–±–æ–π *–ª–æ–≥–∏–∫—É —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ*.
 *
 * - –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ (–ø–æ–∏—Å–∫ –∏–Ω–¥–µ–∫—Å–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ —Ü–µ–Ω–µ –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –º–∞—Å—Å–∏–≤–µ):
 *
function binarySearch(arr, targetPrice) {
    let start = 0;
    let end = arr.length - 1;

    while (start <= end) {
        let mid = Math.floor((start + end) / 2);
        
        if (arr[mid].price === targetPrice) {
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏–Ω–¥–µ–∫—Å –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
            return mid; 
        } else if (arr[mid].price < targetPrice) {
            // –ò—Å–∫–æ–º—ã–π —ç–ª–µ–º–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–∞–≤–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ
            start = mid + 1;
        } else {
            // –ò—Å–∫–æ–º—ã–π —ç–ª–µ–º–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ª–µ–≤–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ
            end = mid - 1;
        }
    }
    return -1; // –≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
}
*/
```
